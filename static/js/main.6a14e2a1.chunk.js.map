{"version":3,"sources":["components/FamilyNode/FamilyNode.module.css","components/PinchZoomPan/PinchZoomPan.tsx","components/FamilyNode/FamilyNode.tsx","utils.ts","components/App/App.tsx","index.tsx","components/PinchZoomPan/PinchZoomPan.module.css","components/App/App.module.css"],"names":["module","exports","React","memo","min","max","captureWheel","className","style","children","root","useRef","useEffect","element","current","create","minZoom","maxZoom","ref","classNames","css","point","canvas","node","isRoot","search","highlightBirthday","onClick","onSubClick","dates","_","compact","birthday","deathday","join","captures","image","match","imageId","isMatch","RegExp","escapeRegExp","test","name","date","parse","Date","currentDate","setYear","getYear","days","differenceInDays","birthdayThisWeek","styles","id","inner","gender","src","alt","title","anonymous","xmlns","viewBox","fill","fillRule","d","clipRule","from","age","computeRelation","member","type","computeMember","members","computeGenre","parents","map","filter","item","father","mother","computeParents","siblings","computeSiblings","spouses","spouse","computeSpouses","computeChildren","passphrase","setPassphrase","useState","window","localStorage","getItem","error","setError","fetching","setFetching","nodes","setNodes","highlightBirthdays","setHighlightBirthdays","setSearch","defaultId","setDefaultId","rootId","setRootId","onResetClick","useCallback","fetchMembers","async","url","ciphertext","bytes","CryptoJS","AES","decrypt","toString","enc","Utf8","e","response","fetch","ok","setItem","text","data","Papa","header","row","computeMembers","removeItem","prompt","emoji","role","aria-label","searcher","value","onChange","target","defaultChecked","checked","description","loading","wrapper","width","height","tree","renderNode","key","transform","left","top","reset","ReactDOM","render","document","getElementById"],"mappings":"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","file":"static/js/main.6a14e2a1.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"root\":\"FamilyNode_root__1MX6K\",\"inner\":\"FamilyNode_inner__3gImM\",\"match\":\"FamilyNode_match__1WwEW\",\"image\":\"FamilyNode_image__19yH7\",\"anonymous\":\"FamilyNode_anonymous__3m582\",\"name\":\"FamilyNode_name__kMFgk\",\"from\":\"FamilyNode_from__2AMA7\",\"date\":\"FamilyNode_date__1wauX\",\"age\":\"FamilyNode_age__3hCed\",\"male\":\"FamilyNode_male__2W4NO\",\"female\":\"FamilyNode_female__3NgRT\",\"isRoot\":\"FamilyNode_isRoot__3viB_\",\"birthday\":\"FamilyNode_birthday__100A7\",\"blink\":\"FamilyNode_blink__1s_Te\"};","import React, { useEffect, useRef } from 'react';\nimport classNames from 'classnames';\nimport { create } from 'pinch-zoom-pan';\n\nimport css from './PinchZoomPan.module.css';\n\ninterface IProps {\n  min?: number;\n  max?: number;\n  captureWheel?: boolean;\n  className?: string;\n  style?: React.CSSProperties;\n  children: React.ReactNode;\n}\n\nexport default React.memo<IProps>(\n  function PinchZoomPan({ min, max, captureWheel, className, style, children }) {\n    const root = useRef<HTMLDivElement>(null);\n\n    useEffect(() => {\n      const element = root.current;\n      if (!element) return;\n      return create({ element, minZoom: min, maxZoom: max, captureWheel });\n    }, [min, max, captureWheel]);\n\n    return (\n      <div ref={root} className={classNames(className, css.root)} style={style}>\n        <div className={css.point}>\n          <div className={css.canvas}>\n            {children}\n          </div>\n        </div>\n      </div>\n    );\n  },\n);\n","import React from 'react';\nimport _ from 'lodash';\nimport classNames from 'classnames';\nimport { ExtMember } from '../../types'\nimport styles from './FamilyNode.module.css';\nimport { getYear, setYear, parse, differenceInDays } from 'date-fns'\n\ninterface Props {\n  node: ExtMember;\n  isRoot: boolean;\n  search?: string,\n  highlightBirthday: boolean,\n  onClick: (id: string) => void;\n  onSubClick: (id: string) => void;\n  style?: React.CSSProperties;\n}\n\nexport default React.memo<Props>(\n  function FamilyNode({ node, isRoot, search, highlightBirthday, onClick, onSubClick, style }) {\n    const dates = _.compact([node.birthday, node.deathday]).join(' - ')\n    const captures = (node.image || '').match(/https:\\/\\/drive.google.com\\/file\\/d\\/(.*)\\/view/)\n    const imageId = captures && captures[1]\n    const isMatch = !!search && (new RegExp(_.escapeRegExp(search), 'i')).test(node.name)\n\n    const date = parse(node.birthday, 'd/M/yyyy', new Date())\n    const currentDate = setYear(date, getYear(new Date()))\n    const days = differenceInDays(currentDate, new Date())\n    const birthdayThisWeek = highlightBirthday && days >= 0 && days < 15 && !node.deathday\n\n    return (\n      <div\n        className={classNames(\n          styles.root,\n          birthdayThisWeek && styles.birthday,\n          isMatch && styles.match\n        )}\n        style={style}\n        onClick={() => { onClick(node.id) }}\n      >\n        <div\n          className={classNames(\n            styles.inner,\n            styles[node.gender],\n            isRoot && styles.isRoot,\n          )}\n        >\n          {imageId && (\n            <img className={styles.image} src={`https://drive.google.com/thumbnail?id=${imageId}`} alt={node.name} title={node.name} />\n          )}\n          {!imageId && (\n            <div className={styles.anonymous}>\n              <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 20 20\" fill=\"currentColor\">\n                <path fillRule=\"evenodd\" d=\"M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z\" clipRule=\"evenodd\" />\n              </svg>\n            </div>\n          )}\n          <p className={styles.name}>{node.name || '-'}</p>\n\n          <p className={styles.from}>{node.from || '-'}</p>\n\n          <p className={styles.date}>\n            {dates}\n            {node.age && node.deathday && (\n              <span className={styles.age}>({node.age})</span>\n            )}\n          </p>\n        </div>\n      </div>\n    );\n  }\n);\n","import CryptoJS from 'crypto-js';\nimport { Gender, RelType, Relation } from 'relatives-tree/lib/types';\nimport { Member } from './types'\nimport Papa from 'papaparse'\nimport _ from 'lodash'\n\nconst NAME='Nom'\nconst FATHER='Pare'\nconst MOTHER='Mare'\nconst GENDER='G√®nere'\nconst FROM='Lloc de naixament'\nconst BIRTHDAY='Data de naixament'\nconst DEFUNCT='Data de defunci√≥'\nconst SPOUSE='C√≤njuge'\nconst IMAGE='Foto'\nconst AGE='Edat'\n\nconst MALE='Home'\nconst FEMALE='Dona'\n\ninterface IHash<T> {\n  [index: string]: T;\n}\n\ntype Rows = Array<IHash<string>>\n\ninterface DataMember {\n  id: string,\n  name: string,\n  father: string,\n  mother: string,\n  spouse: string,\n  gender: string,\n  from: string,\n  image: string,\n  birthday: string,\n  deathday: string,\n  age: string\n}\n\ntype DataMembers = Array<DataMember>\n\n // Auxiliary functions\n const computeRelation = (member: DataMember, type: RelType): Relation => {\n   return {\n     id: member.id,\n     type\n   }\n }\n const computeParents = (members: DataMembers, member: DataMember): Array<Relation> => {\n   return _.map(\n     _.filter(members, (item) => {\n       return member.father === item.name || member.mother === item.name\n     }),\n     (member: DataMember) => computeRelation(member, 'blood' as RelType)\n   )\n }\n\n const computeSiblings = (members: DataMembers, member: DataMember): Array<Relation> => {\n   return _.map(\n     _.filter(members, (item) => {\n       return (\n         member.father === item.father &&\n         member.mother === item.mother &&\n         member.name !== item.name\n       )\n     }),\n     (member: DataMember) => computeRelation(member, 'blood' as RelType)\n   )\n }\n\n const computeSpouses = (members: DataMembers, member: DataMember): Array<Relation> => {\n   const spouses = _.filter(members, (item) => item.name === member.spouse)\n\n   return _.map(\n     spouses,\n     (member: DataMember) => computeRelation(member, 'married' as RelType)\n   )\n }\n\n const computeChildren = (members: DataMembers, member: DataMember): Array<Relation> => {\n   return _.map(\n     _.filter(members, (item) => {\n       return (\n         member.name === item.father ||\n         member.name === item.mother\n       )\n     }),\n     (member: DataMember) => computeRelation(member, 'blood' as RelType)\n   )\n }\n\n const computeGenre = (members: DataMembers, member: DataMember): Gender => {\n   if (member.gender === MALE) {\n     return 'male' as Gender\n   } else if (member.gender === FEMALE) {\n     return 'female' as Gender\n   } else {\n     return 'male' as Gender // TODO: Unknown\n   }\n }\n\nconst computeMember = (members: DataMembers, member: DataMember) => {\n   const gender = computeGenre(members, member)\n   const parents = computeParents(members, member)\n   const siblings = computeSiblings(members, member)\n   const spouses = computeSpouses(members, member)\n   const children = computeChildren(members, member)\n\n   return {\n     id: member.id,\n     name: member.name,\n     from: member.from,\n     birthday: member.birthday,\n     deathday: member.deathday,\n     age: member.age,\n     image: member.image,\n\n     gender,\n     parents,\n     siblings,\n     spouses,\n     children\n   }\n }\n\n const mapMembers = (rows: Rows) => {\n   return rows.map((row) => {\n     const name = row[NAME] as string\n     const from = row[FROM] as string\n     const birthday = row[BIRTHDAY] as string\n     const deathday = row[DEFUNCT] as string\n     const gender = row[GENDER] as string\n     const father = row[FATHER] as string\n     const mother = row[MOTHER] as string\n     const spouse = row[SPOUSE] as string\n     const image = row[IMAGE] as string\n     const age = row[AGE] as string\n\n     if (!name) return null\n\n     // NOTE: Ensure unique. Names are not unique sometimes...\n     // const hash = crypto.createHash('sha1')\n     // const id = hash.update(name, 'utf-8' as Utf8AsciiLatin1Encoding).digest('hex').slice(0, 6)\n\n     return {\n       id: name,\n       name,\n       father,\n       mother,\n       spouse,\n       from,\n       birthday,\n       deathday,\n       image,\n       gender,\n       age\n     }\n   })\n}\n\nexport const computeMembers = async (text: string): Promise<Array<Member>> => {\n  const { data } = Papa.parse<IHash<string>>(text, { header: true });\n\n  const members: DataMembers = _.compact(mapMembers(data))\n\n  return members.map((member: DataMember) => computeMember(members, member))\n}\n\nexport const anonymizeMembers = (members: Array<Member>) => {\n  const anonymous = members.map((member, index) => _.pickBy({\n    ...member,\n    // name: `Member #${index}`,\n    from: null,\n    birthday: null,\n    deathday: null,\n    image: null\n  }, _.identity))\n\n  return anonymous\n}\n\nexport const decrypt = (ciphertext: string, passphrase: string) => {\n  try {\n    const bytes = CryptoJS.AES.decrypt(ciphertext, passphrase);\n    const originalText = bytes.toString(CryptoJS.enc.Utf8);\n\n    return originalText;\n  } catch (e) {\n    return '';\n  }\n}\n\nexport const encrypt = (text: string, passphrase: string) => {\n  return CryptoJS.AES.encrypt(text, passphrase).toString()\n}\n","import React, { useState, useCallback, useEffect } from 'react';\nimport ReactFamilyTree from 'react-family-tree';\nimport PinchZoomPan from '../PinchZoomPan/PinchZoomPan';\nimport FamilyNode from '../FamilyNode/FamilyNode';\nimport { Node, ExtNode } from 'relatives-tree/lib/types';\nimport { Member, ExtMember } from '../../types'\n\nimport { decrypt, computeMembers } from '../../utils'\n\nimport styles from './App.module.css';\n\nconst eurl = 'U2FsdGVkX186bIgFZtZlz05ejtdGVBx5NqCEaBf8euwiqUXeN5+tiZuQYOdlemNKBhLOItq42c2wOMWiiVgk8Ui9TGBOZ7NSYSKI0FSD/wxN4pmLk/WqwG9DzaYmDPavag3vPsUU3jYnvplxp8Ya4BKN5kzcIo7GIudPhLjshVeOXoftWuKj3mbtKwI7ORf9GlD72qC8mVA0aHy1fZrcGTeGBAV3UuzThH626WUaUDDWynZ94GlVfVdb9IlCvPA9'\n\nconst WIDTH = 190;\nconst HEIGHT = 220;\n\nexport default React.memo<{}>(\n  function App() {\n    const [passphrase, setPassphrase] = useState<string>(window.localStorage.getItem('passphrase') || '');\n    const [error, setError] = useState<boolean>(false);\n    const [fetching, setFetching] = useState<boolean>(true);\n    const [nodes, setNodes] = useState<Array<Member>>([]);\n\n    const [highlightBirthdays, setHighlightBirthdays] = React.useState<boolean>(true)\n    const [search, setSearch] = useState<string>('');\n    const [defaultId, setDefaultId] = useState<string>('');\n    const [rootId, setRootId] = useState<string>('');\n    const onResetClick = useCallback(() => setRootId(defaultId), [defaultId]);\n\n    const fetchMembers = async () => {\n      const url = decrypt(eurl, passphrase)\n\n      if (url.match(/https/)) {\n        const response = await fetch(url)\n\n        if (response.ok) {\n          window.localStorage.setItem('passphrase', passphrase)\n\n          const text = await response.text()\n          const members: Array<Member> = await computeMembers(text)\n\n          setNodes(members)\n          setRootId(members[0].id)\n          setDefaultId(members[0].id)\n        } else {\n          setPassphrase('')\n          window.localStorage.removeItem('passphrase')\n          setError(true)\n        }\n      } else {\n        setPassphrase('')\n        window.localStorage.removeItem('passphrase')\n        setError(true)\n      }\n\n      setFetching(false)\n    }\n\n    useEffect(() => {\n      if (!passphrase) {\n        setPassphrase(prompt('Clau d\\'acc√©s:') || '')\n      }\n    }, []) // eslint-disable-line react-hooks/exhaustive-deps\n\n    useEffect(() => {\n      if (passphrase) fetchMembers()\n    }, [passphrase]) // eslint-disable-line react-hooks/exhaustive-deps\n\n    const onFetchData = () => {\n      setFetching(true)\n      fetchMembers()\n    }\n\n    const onSearch = (e: React.ChangeEvent<HTMLInputElement>) => {\n      setSearch(e && e.target.value)\n    }\n\n    const onHighlightBirthdays = (e: React.ChangeEvent<HTMLInputElement>) => {\n      setHighlightBirthdays(e && e.target.checked)\n    }\n\n    if (!passphrase) return null\n\n    return (\n      <div className={styles.root}>\n        <header className={styles.header}>\n          <h1 className={styles.title}>\n            <span className={styles.emoji} role=\"img\" aria-label=\"Arbre\">\n             üå≥\n            </span>\n            Arbre Geneal√≤gic\n          </h1>\n          <div className={styles.searcher}>\n            <span className={styles.emoji} role=\"img\" aria-label=\"Cercar\">\n             üîç\n            </span>\n            Cercar: <input type=\"text\" value={search} onChange={onSearch} />\n          </div>\n          <div className={styles.searcher}>\n            <span className={styles.emoji} role=\"img\" aria-label=\"Aniversaris\">\n             üéÇ\n            </span>\n            Destacar pr√≤xims aniversaris: <input type=\"checkbox\" defaultChecked={highlightBirthdays} onChange={onHighlightBirthdays} />\n          </div>\n          <div className={styles.searcher}>\n            <button onClick={onFetchData}>\n              <span className={styles.emoji} role=\"img\" aria-label=\"Recarregar\">\n                üîÅ\n              </span>\n              Carregar de nou les dades\n            </button>\n          </div>\n          <span className={styles.description}>\n            Arbre Geneal√≤gic amb tots els avantpassats coneguts de la nostra familia\n          </span>\n        </header>\n        {error && (\n          <div className={styles.error}>\n            Error carregant les dades!\n          </div>\n        )}\n        {!error && fetching && (\n          <div className={styles.loading}>\n            Carregant...\n          </div>\n        )}\n        {!fetching && nodes && rootId && (\n          <PinchZoomPan\n            min={0.5}\n            max={2.5}\n            captureWheel\n            className={styles.wrapper}\n          >\n            <ReactFamilyTree\n              nodes={nodes as Node[]}\n              rootId={rootId}\n              width={WIDTH}\n              height={HEIGHT}\n              className={styles.tree}\n              renderNode={(node: ExtNode) => (\n                <FamilyNode\n                  key={node.id}\n                  node={node as ExtMember}\n                  isRoot={node.id === rootId}\n                  search={search}\n                  highlightBirthday={highlightBirthdays}\n                  onSubClick={setRootId}\n                  onClick={setRootId}\n                  style={{\n                    width: WIDTH,\n                    height: HEIGHT,\n                    transform: `translate(${node.left * (WIDTH / 2)}px, ${node.top * (HEIGHT / 2)}px)`,\n                  }}\n                />\n              )}\n            />\n          </PinchZoomPan>\n        )}\n        {rootId !== defaultId && (\n          <div className={styles.reset} onClick={onResetClick}>\n            Reset\n          </div>\n        )}\n      </div>\n    );\n  }\n);\n","import './index.css';\n\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './components/App/App';\n\nReactDOM.render(<App />, document.getElementById('root'));\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"root\":\"PinchZoomPan_root__9P_Qv\",\"point\":\"PinchZoomPan_point__2y-JG\",\"canvas\":\"PinchZoomPan_canvas__EVab0\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"root\":\"App_root__1Jh3p\",\"header\":\"App_header__2MS2l\",\"title\":\"App_title__1YcTA\",\"wrapper\":\"App_wrapper__3ox-V\",\"emoji\":\"App_emoji__1WAbk\",\"tree\":\"App_tree__1-Ar8\",\"reset\":\"App_reset__2p6Ak\",\"description\":\"App_description__h9e0b\",\"loading\":\"App_loading__Poh4x\",\"error\":\"App_error__AnA0Y\"};"],"sourceRoot":""}