{"version":3,"sources":["components/FamilyNode/FamilyNode.module.css","components/PinchZoomPan/PinchZoomPan.tsx","components/FamilyNode/FamilyNode.tsx","utils.ts","components/App/App.tsx","index.tsx","components/PinchZoomPan/PinchZoomPan.module.css","components/App/App.module.css"],"names":["module","exports","React","memo","min","max","captureWheel","className","style","children","root","useRef","useEffect","element","current","create","minZoom","maxZoom","ref","classNames","css","point","canvas","node","isRoot","search","highlightBirthday","onClick","onSubClick","dates","_","compact","birthday","deathday","join","captures","image","match","imageId","isMatch","RegExp","escapeRegExp","test","name","date","parse","Date","currentDate","setYear","getYear","days","differenceInDays","birthdayThisWeek","styles","id","inner","gender","src","alt","title","anonymous","xmlns","viewBox","fill","fillRule","d","clipRule","from","age","computeRelation","member","type","computeMember","members","computeGenre","parents","map","filter","item","father","mother","computeParents","siblings","computeSiblings","spouses","spouse","computeSpouses","computeChildren","computeMembers","async","data","Papa","text","header","row","passphrase","setPassphrase","useState","error","setError","fetching","setFetching","nodes","setNodes","highlightBirthdays","setHighlightBirthdays","setSearch","defaultId","setDefaultId","rootId","setRootId","onResetClick","useCallback","fetchMembers","url","ciphertext","bytes","CryptoJS","AES","decrypt","toString","enc","Utf8","e","response","fetch","ok","annonymous","index","pickBy","identity","console","log","prompt","emoji","role","aria-label","searcher","value","onChange","target","defaultChecked","checked","description","loading","wrapper","width","height","tree","renderNode","key","transform","left","top","reset","ReactDOM","render","document","getElementById"],"mappings":"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","file":"static/js/main.27ff8966.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"root\":\"FamilyNode_root__1MX6K\",\"inner\":\"FamilyNode_inner__3gImM\",\"match\":\"FamilyNode_match__1WwEW\",\"image\":\"FamilyNode_image__19yH7\",\"anonymous\":\"FamilyNode_anonymous__3m582\",\"name\":\"FamilyNode_name__kMFgk\",\"from\":\"FamilyNode_from__2AMA7\",\"date\":\"FamilyNode_date__1wauX\",\"age\":\"FamilyNode_age__3hCed\",\"male\":\"FamilyNode_male__2W4NO\",\"female\":\"FamilyNode_female__3NgRT\",\"isRoot\":\"FamilyNode_isRoot__3viB_\",\"birthday\":\"FamilyNode_birthday__100A7\",\"blink\":\"FamilyNode_blink__1s_Te\"};","import React, { useEffect, useRef } from 'react';\nimport classNames from 'classnames';\nimport { create } from 'pinch-zoom-pan';\n\nimport css from './PinchZoomPan.module.css';\n\ninterface IProps {\n  min?: number;\n  max?: number;\n  captureWheel?: boolean;\n  className?: string;\n  style?: React.CSSProperties;\n  children: React.ReactNode;\n}\n\nexport default React.memo<IProps>(\n  function PinchZoomPan({ min, max, captureWheel, className, style, children }) {\n    const root = useRef<HTMLDivElement>(null);\n\n    useEffect(() => {\n      const element = root.current;\n      if (!element) return;\n      return create({ element, minZoom: min, maxZoom: max, captureWheel });\n    }, [min, max, captureWheel]);\n\n    return (\n      <div ref={root} className={classNames(className, css.root)} style={style}>\n        <div className={css.point}>\n          <div className={css.canvas}>\n            {children}\n          </div>\n        </div>\n      </div>\n    );\n  },\n);\n","import React from 'react';\nimport _ from 'lodash';\nimport classNames from 'classnames';\nimport { ExtMember } from '../../types'\nimport styles from './FamilyNode.module.css';\nimport { getYear, setYear, parse, differenceInDays } from 'date-fns'\n\ninterface Props {\n  node: ExtMember;\n  isRoot: boolean;\n  search?: string,\n  highlightBirthday: boolean,\n  onClick: (id: string) => void;\n  onSubClick: (id: string) => void;\n  style?: React.CSSProperties;\n}\n\nexport default React.memo<Props>(\n  function FamilyNode({ node, isRoot, search, highlightBirthday, onClick, onSubClick, style }) {\n    const dates = _.compact([node.birthday, node.deathday]).join(' - ')\n    const captures = (node.image || '').match(/https:\\/\\/drive.google.com\\/file\\/d\\/(.*)\\/view/)\n    const imageId = captures && captures[1]\n    const isMatch = !!search && (new RegExp(_.escapeRegExp(search), 'i')).test(node.name)\n\n    const date = parse(node.birthday, 'd/M/yyyy', new Date())\n    const currentDate = setYear(date, getYear(new Date()))\n    const days = differenceInDays(currentDate, new Date())\n    const birthdayThisWeek = highlightBirthday && days >= 0 && days < 15 && !node.deathday\n\n    return (\n      <div\n        className={classNames(\n          styles.root,\n          birthdayThisWeek && styles.birthday,\n          isMatch && styles.match\n        )}\n        style={style}\n        onClick={() => { onClick(node.id) }}\n      >\n        <div\n          className={classNames(\n            styles.inner,\n            styles[node.gender],\n            isRoot && styles.isRoot,\n          )}\n        >\n          {imageId && (\n            <img className={styles.image} src={`https://drive.google.com/thumbnail?id=${imageId}`} alt={node.name} title={node.name} />\n          )}\n          {!imageId && (\n            <div className={styles.anonymous}>\n              <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 20 20\" fill=\"currentColor\">\n                <path fillRule=\"evenodd\" d=\"M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z\" clipRule=\"evenodd\" />\n              </svg>\n            </div>\n          )}\n          <p className={styles.name}>{node.name || '-'}</p>\n\n          <p className={styles.from}>{node.from || '-'}</p>\n\n          <p className={styles.date}>\n            {dates}\n            {node.age && node.deathday && (\n              <span className={styles.age}>({node.age})</span>\n            )}\n          </p>\n        </div>\n      </div>\n    );\n  }\n);\n","// import crypto, { Utf8AsciiLatin1Encoding } from 'crypto'\nimport { Gender, RelType, Relation } from 'relatives-tree/lib/types';\nimport { Member } from './types'\nimport Papa from 'papaparse'\nimport _ from 'lodash'\n\nconst NAME='Nom'\nconst FATHER='Pare'\nconst MOTHER='Mare'\nconst GENDER='G√®nere'\nconst FROM='Lloc de naixament'\nconst BIRTHDAY='Data de naixament'\nconst DEFUNCT='Data de defunci√≥'\nconst SPOUSE='C√≤njuge'\nconst IMAGE='Foto'\nconst AGE='Edat'\n\nconst MALE='Home'\nconst FEMALE='Dona'\n\ninterface IHash<T> {\n  [index: string]: T;\n}\n\ntype Rows = Array<IHash<string>>\n\ninterface DataMember {\n  id: string,\n  name: string,\n  father: string,\n  mother: string,\n  spouse: string,\n  gender: string,\n  from: string,\n  image: string,\n  birthday: string,\n  deathday: string,\n  age: string\n}\n\ntype DataMembers = Array<DataMember>\n\n // Auxiliary functions\n const computeRelation = (member: DataMember, type: RelType): Relation => {\n   return {\n     id: member.id,\n     type\n   }\n }\n const computeParents = (members: DataMembers, member: DataMember): Array<Relation> => {\n   return _.map(\n     _.filter(members, (item) => {\n       return member.father === item.name || member.mother === item.name\n     }),\n     (member: DataMember) => computeRelation(member, 'blood' as RelType)\n   )\n }\n\n const computeSiblings = (members: DataMembers, member: DataMember): Array<Relation> => {\n   return _.map(\n     _.filter(members, (item) => {\n       return (\n         member.father === item.father &&\n         member.mother === item.mother &&\n         member.name !== item.name\n       )\n     }),\n     (member: DataMember) => computeRelation(member, 'blood' as RelType)\n   )\n }\n\n const computeSpouses = (members: DataMembers, member: DataMember): Array<Relation> => {\n   const spouses = _.filter(members, (item) => item.name === member.spouse)\n\n   return _.map(\n     spouses,\n     (member: DataMember) => computeRelation(member, 'married' as RelType)\n   )\n }\n\n const computeChildren = (members: DataMembers, member: DataMember): Array<Relation> => {\n   return _.map(\n     _.filter(members, (item) => {\n       return (\n         member.name === item.father ||\n         member.name === item.mother\n       )\n     }),\n     (member: DataMember) => computeRelation(member, 'blood' as RelType)\n   )\n }\n\n const computeGenre = (members: DataMembers, member: DataMember): Gender => {\n   if (member.gender === MALE) {\n     return 'male' as Gender\n   } else if (member.gender === FEMALE) {\n     return 'female' as Gender\n   } else {\n     return 'male' as Gender // TODO: Unknown\n   }\n }\n\nconst computeMember = (members: DataMembers, member: DataMember) => {\n   const gender = computeGenre(members, member)\n   const parents = computeParents(members, member)\n   const siblings = computeSiblings(members, member)\n   const spouses = computeSpouses(members, member)\n   const children = computeChildren(members, member)\n\n   return {\n     id: member.id,\n     name: member.name,\n     from: member.from,\n     birthday: member.birthday,\n     deathday: member.deathday,\n     age: member.age,\n     image: member.image,\n\n     gender,\n     parents,\n     siblings,\n     spouses,\n     children\n   }\n }\n\n const mapMembers = (rows: Rows) => {\n   return rows.map((row) => {\n     const name = row[NAME] as string\n     const from = row[FROM] as string\n     const birthday = row[BIRTHDAY] as string\n     const deathday = row[DEFUNCT] as string\n     const gender = row[GENDER] as string\n     const father = row[FATHER] as string\n     const mother = row[MOTHER] as string\n     const spouse = row[SPOUSE] as string\n     const image = row[IMAGE] as string\n     const age = row[AGE] as string\n\n     if (!name) return null\n\n     // NOTE: Ensure unique. Names are not unique sometimes...\n     // const hash = crypto.createHash('sha1')\n     // const id = hash.update(name, 'utf-8' as Utf8AsciiLatin1Encoding).digest('hex').slice(0, 6)\n\n     return {\n       id: name,\n       name,\n       father,\n       mother,\n       spouse,\n       from,\n       birthday,\n       deathday,\n       image,\n       gender,\n       age\n     }\n   })\n}\n\nconst computeMembers = async (text: string): Promise<Array<Member>> => {\n  const { data } = Papa.parse<IHash<string>>(text, { header: true });\n\n  const members: DataMembers = _.compact(mapMembers(data))\n\n  return members.map((member: DataMember) => computeMember(members, member))\n}\n\nexport default computeMembers\n","import React, { useState, useCallback, useEffect } from 'react';\nimport _ from 'lodash'\nimport CryptoJS from 'crypto-js';\nimport ReactFamilyTree from 'react-family-tree';\nimport PinchZoomPan from '../PinchZoomPan/PinchZoomPan';\nimport FamilyNode from '../FamilyNode/FamilyNode';\nimport { Node, ExtNode } from 'relatives-tree/lib/types';\nimport { Member, ExtMember } from '../../types'\n\nimport computeMembers from '../../utils'\n\nimport styles from './App.module.css';\n\nconst eurl = 'U2FsdGVkX19y1HrmBM266ECLkq9iWyGhsaicssPfVQcXIdhtLasZroSugpJf0yR64bN7AlL9t0aUKaTT2yqw+ZBaAz7LGWDjae1wM1FLmLXUUSuQEwYsGiL2cCj/e6GwtkgQ7oupjqc6PHeNfvcoKvUuXzeSDyV7s1TUiRqctQocVEfB4imdGxgW85eQUonA94EEqAiuj2enBhw/d8Qq/UDI/4HQeoENIa8NUfezBQFvn+d+XjiHt2dNwL0wKR/S'\nconst WIDTH = 190;\nconst HEIGHT = 220;\n\nexport default React.memo<{}>(\n  function App() {\n    const [passphrase, setPassphrase] = useState<string>('');\n    const [error, setError] = useState<boolean>(false);\n    const [fetching, setFetching] = useState<boolean>(true);\n    const [nodes, setNodes] = useState<Array<Member>>([]);\n\n    const [highlightBirthdays, setHighlightBirthdays] = React.useState<boolean>(true)\n    const [search, setSearch] = useState<string>('');\n    const [defaultId, setDefaultId] = useState<string>('');\n    const [rootId, setRootId] = useState<string>('');\n    const onResetClick = useCallback(() => setRootId(defaultId), [defaultId]);\n\n    const decrypt = (ciphertext: string, passphrase: string) => {\n      try {\n        const bytes = CryptoJS.AES.decrypt(ciphertext, passphrase);\n        const originalText = bytes.toString(CryptoJS.enc.Utf8);\n\n        return originalText;\n      } catch (e) {\n        return '';\n      }\n    }\n\n    const fetchMembers = async () => {\n      const url = decrypt(eurl, passphrase)\n\n      if (url.match(/https/)) {\n        const response = await fetch(url)\n\n        if (response.ok) {\n          const text = await response.text()\n          const members: Array<Member> = await computeMembers(text)\n\n          const annonymous = members.map((member, index) => _.pickBy({\n            ...member,\n            // name: `Member #${index}`,\n            from: null,\n            birthday: null,\n            deathday: null,\n            image: null\n          }, _.identity))\n\n          console.log(members)\n          console.log(annonymous)\n\n          setNodes(members)\n          setRootId(members[0].id)\n          setDefaultId(members[0].id)\n        } else {\n          setError(true)\n        }\n      } else {\n        setError(true)\n      }\n\n      setFetching(false)\n    }\n\n    useEffect(() => {\n      setPassphrase(prompt('Clau d\\'acc√©s') || '')\n    }, [])\n\n    useEffect(() => {\n      if (passphrase) fetchMembers()\n    }, [passphrase]) // eslint-disable-line react-hooks/exhaustive-deps\n\n    const onFetchData = () => {\n      setFetching(true)\n      fetchMembers()\n    }\n\n    const onSearch = (e: React.ChangeEvent<HTMLInputElement>) => {\n      setSearch(e && e.target.value)\n    }\n\n    const onHighlightBirthdays = (e: React.ChangeEvent<HTMLInputElement>) => {\n      setHighlightBirthdays(e && e.target.checked)\n    }\n\n    if (!passphrase) return null\n\n    return (\n      <div className={styles.root}>\n        <header className={styles.header}>\n          <h1 className={styles.title}>\n            <span className={styles.emoji} role=\"img\" aria-label=\"Arbre\">\n             üå≥\n            </span>\n            Arbre Geneal√≤gic\n          </h1>\n          <div className={styles.searcher}>\n            <span className={styles.emoji} role=\"img\" aria-label=\"Cercar\">\n             üîç\n            </span>\n            Cercar: <input type=\"text\" value={search} onChange={onSearch} />\n          </div>\n          <div className={styles.searcher}>\n            <span className={styles.emoji} role=\"img\" aria-label=\"Aniversaris\">\n             üéÇ\n            </span>\n            Destacar pr√≤xims aniversaris: <input type=\"checkbox\" defaultChecked={highlightBirthdays} onChange={onHighlightBirthdays} />\n          </div>\n          <div className={styles.searcher}>\n            <button onClick={onFetchData}>\n              <span className={styles.emoji} role=\"img\" aria-label=\"Recarregar\">\n                üîÅ\n              </span>\n              Carregar de nou les dades\n            </button>\n          </div>\n          <span className={styles.description}>\n            Arbre Geneal√≤gic amb tots els avantpassats coneguts de la nostra familia\n          </span>\n        </header>\n        {error && (\n          <div className={styles.error}>\n            Error carregant les dades!\n          </div>\n        )}\n        {!error && fetching && (\n          <div className={styles.loading}>\n            Carregant...\n          </div>\n        )}\n        {!fetching && nodes && rootId && (\n          <PinchZoomPan\n            min={0.5}\n            max={2.5}\n            captureWheel\n            className={styles.wrapper}\n          >\n            <ReactFamilyTree\n              nodes={nodes as Node[]}\n              rootId={rootId}\n              width={WIDTH}\n              height={HEIGHT}\n              className={styles.tree}\n              renderNode={(node: ExtNode) => (\n                <FamilyNode\n                  key={node.id}\n                  node={node as ExtMember}\n                  isRoot={node.id === rootId}\n                  search={search}\n                  highlightBirthday={highlightBirthdays}\n                  onSubClick={setRootId}\n                  onClick={setRootId}\n                  style={{\n                    width: WIDTH,\n                    height: HEIGHT,\n                    transform: `translate(${node.left * (WIDTH / 2)}px, ${node.top * (HEIGHT / 2)}px)`,\n                  }}\n                />\n              )}\n            />\n          </PinchZoomPan>\n        )}\n        {rootId !== defaultId && (\n          <div className={styles.reset} onClick={onResetClick}>\n            Reset\n          </div>\n        )}\n      </div>\n    );\n  }\n);\n","import './index.css';\n\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './components/App/App';\n\nReactDOM.render(<App />, document.getElementById('root'));\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"root\":\"PinchZoomPan_root__9P_Qv\",\"point\":\"PinchZoomPan_point__2y-JG\",\"canvas\":\"PinchZoomPan_canvas__EVab0\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"root\":\"App_root__1Jh3p\",\"header\":\"App_header__2MS2l\",\"title\":\"App_title__1YcTA\",\"wrapper\":\"App_wrapper__3ox-V\",\"emoji\":\"App_emoji__1WAbk\",\"tree\":\"App_tree__1-Ar8\",\"reset\":\"App_reset__2p6Ak\",\"description\":\"App_description__h9e0b\",\"loading\":\"App_loading__Poh4x\",\"error\":\"App_error__AnA0Y\"};"],"sourceRoot":""}